import{I as J,o as p,c as w,a as i,H as M,a3 as W,f,A as Y,D as G,u as Q,g as X,h as Z,i as ee,j as B,E as te,_ as se,r as ae,V as ne,k as a,m as I,l as F,n as S,Y as le,b as g,t as C,w as v,F as N,p as E,e as A,q as re,s as T,v as oe,y as ie,z as ue}from"./index-bf271bc2.js";import{m as de,u as ce,a as pe,s as fe,b as me,c as ye,d as he}from"./device-2affa254.js";import{s as be}from"./selectbutton.esm-8a7e83be.js";import{s as ve}from"./inputtext.esm-bbf7483a.js";import{s as ge}from"./confirmdialog.esm-9d984b49.js";import{u as we}from"./store-272cfbb3.js";import"./paginator.esm-c92cd192.js";import"./dropdown.esm-502d7d03.js";import"./focustrap.esm-557106f8.js";import"./index.esm-3f1c58e4.js";import"./dialog.esm-4c6f0e5e.js";var _e=`
.p-inputswitch {
    display: inline-block;
}

.p-inputswitch-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border: 1px solid transparent;
}

.p-inputswitch-slider:before {
    position: absolute;
    content: '';
    top: 50%;
}
`,Se={root:{position:"relative"}},ke={root:function(t){var n=t.instance,l=t.props;return["p-inputswitch p-component",{"p-inputswitch-checked":n.checked,"p-disabled":l.disabled,"p-focus":n.focused}]},slider:"p-inputswitch-slider"},Pe=J(_e,{name:"inputswitch",manual:!0}),Ce=Pe.load,Oe={name:"BaseInputSwitch",extends:W,props:{modelValue:{type:null,default:!1},trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},disabled:{type:Boolean,default:!1},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},css:{classes:ke,inlineStyles:Se,loadStyle:Ce},provide:function(){return{$parentInstance:this}}},H={name:"InputSwitch",extends:Oe,emits:["click","update:modelValue","change","input","focus","blur"],data:function(){return{focused:!1}},methods:{onClick:function(t){if(!this.disabled){var n=this.checked?this.falseValue:this.trueValue;this.$emit("click",t),this.$emit("update:modelValue",n),this.$emit("change",t),this.$emit("input",n),this.$refs.input.focus()}},onFocus:function(t){this.focused=!0,this.$emit("focus",t)},onBlur:function(t){this.focused=!1,this.$emit("blur",t)}},computed:{checked:function(){return this.modelValue===this.trueValue}}};function O(e){"@babel/helpers - typeof";return O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(e)}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),n.push.apply(n,l)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?U(Object(n),!0).forEach(function(l){Ve(e,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(n,l))})}return e}function Ve(e,t,n){return t=$e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(e){var t=xe(e,"string");return O(t)==="symbol"?t:String(t)}function xe(e,t){if(O(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var l=n.call(e,t||"default");if(O(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var je=["id","checked","disabled","aria-checked","aria-labelledby","aria-label"];function Le(e,t,n,l,d,m){return p(),w("div",M({class:e.cx("root"),style:e.sx("root"),onClick:t[2]||(t[2]=function(h){return m.onClick(h)})},e.ptm("root"),{"data-pc-name":"inputswitch"}),[i("div",M({class:"p-hidden-accessible"},e.ptm("hiddenInputWrapper"),{"data-p-hidden-accessible":!0}),[i("input",M({ref:"input",id:e.inputId,type:"checkbox",role:"switch",class:e.inputClass,style:e.inputStyle,checked:m.checked,disabled:e.disabled,"aria-checked":m.checked,"aria-labelledby":e.ariaLabelledby,"aria-label":e.ariaLabel,onFocus:t[0]||(t[0]=function(h){return m.onFocus(h)}),onBlur:t[1]||(t[1]=function(h){return m.onBlur(h)})},K(K({},e.inputProps),e.ptm("hiddenInput"))),null,16,je)],16),i("span",M({class:e.cx("slider")},e.ptm("slider")),null,16)],16)}H.render=Le;const Me=()=>{const e=f(!0),t=we(),n=Y(),l=G(),d=f(!0),m=f(),h=Q(),V=f(),u=f({}),_=f(),$=f(0),k=f(""),z=f(["Edited","Discharged"]),x=f([{field:"id",header:"ID",selected:!1,style:"min-width: 5rem",frozen:!1},{field:"am_number",header:"AM Number",sortable:!0,selected:!0,style:"min-width: 5rem"},{field:"patient_name",header:"Patient",sortable:!0,selected:!0,style:"min-width: 5rem"}]),c=f(null);X(()=>{d.value=l.query.online!==void 0?JSON.parse(l.query.online):!0,o(),b()}),Z(()=>{t.$dispose()});const b=async()=>{e.value=!0,await t.fetchAll({page:u.value.page+=1,per_page:u.value.rows,order:de(u.value.multiSortMeta),search:k.value,status:c.value},d.value);const r=t.getAllResponse;r&&(_.value=r.data,$.value=r.meta.total),e.value=!1},D=()=>{h.require({message:"Are you sure you want to upload all Offline Cases?",header:"Confirmation",icon:"pi pi-question text-primary-900",rejectClass:"p-button-secondary p-button-text",acceptClass:"p-button-primary p-button-text",accept:async()=>{e.value=!0;let r=0;_.value.forEach(async P=>{await j(P),r++,r==_.value.length&&(q("Switching to online mode ...","info"),_.value=null,d.value=!0,o(),b())})},reject:()=>{}})},j=async r=>{try{await t.add(r.data,!0),t.getAddResponse&&(await t.deleteOfflineCase({id:parseInt(r.id)}),q("Case - Patient: "+r.patient_name+" Uploaded","success"))}catch{e.value=!1}},o=()=>{u.value={page:0,rows:V.value.rows,multiSortMeta:[],first:0}},L=r=>{u.value=r,u.value.multiSortMeta=[],b()},R=r=>{u.value=r,u.value.page=0,u.value.first=0,b()},s=r=>{m.value.toggle(r)},y=ee(()=>x.value.filter(r=>r.selected));B([k],ce(()=>{o(),b()},500)),B([c],()=>{o(),b()}),B([d],()=>{console.log(d.value),n.push({path:l.path,query:{...l.query,online:d.value}}),o(),b()});const q=(r,P="error")=>{te.emit("show-toast",{severity:P,summary:"",detail:r,life:3e3})};return{dt:V,lazyParams:u,totalRecords:$,records:_,isLoading:e,search:k,statusOptions:z,selectedStatus:c,onPage:L,onSort:R,toggleColumnMenu:s,selectedColumns:y,columns:x,columnMenu:m,isOnline:d,syncOfflineCase:D}};const Ie=e=>(ie("data-v-1fdf397a"),e=e(),ue(),e),ze={class:"card mb-4"},De={class:"flex justify-content-left"},Re={key:1,class:"flex-1"},Be={class:"input-switch-container flex-2"},Fe={class:"offline-label text-lg"},Ne={class:"card"},qe={class:"flex flex-wrap flex-row-reverse align-items-center"},Ee={class:"p-input-icon-left mr-2 mb-2 flex-1"},Ae=Ie(()=>i("i",{class:"pi pi-search"},null,-1)),Te=["for"],Ue={key:0},Ke={key:1},He={class:"text-center w-full"},Je={class:"mt-2"},We={__name:"List",setup(e){const{statusOptions:t,selectedStatus:n,dt:l,lazyParams:d,totalRecords:m,records:h,isLoading:V,search:u,onPage:_,onSort:$,selectedColumns:k,columns:z,columnMenu:x,isOnline:c,syncOfflineCase:b}=Me(),{isMobile:D}=pe();return(j,o)=>{const L=ae("router-link"),R=ne("tooltip");return p(),w(N,null,[i("div",null,[i("div",ze,[i("div",De,[a(c)?(p(),I(a(be),{key:0,class:"flex-1",modelValue:a(n),"onUpdate:modelValue":o[0]||(o[0]=s=>F(n)?n.value=s:null),options:a(t),"aria-labelledby":"basic"},null,8,["modelValue","options"])):S("",!0),a(c)?S("",!0):(p(),w("div",Re,[le(g(a(T),{onClick:a(b),icon:"pi pi-sync",label:"Sync",text:""},null,8,["onClick"]),[[R,"Upload Offline Cases",void 0,{top:!0}]])])),i("div",Be,[i("span",Fe,C(a(c)?"Online":"Offline"),1),g(a(H),{modelValue:a(c),"onUpdate:modelValue":o[1]||(o[1]=s=>F(c)?c.value=s:null),inputClass:"success",class:"input-switch"},null,8,["modelValue"])])])]),i("div",Ne,[g(a(he),{ref_key:"dt",ref:l,dataKey:"id",lazy:!0,paginator:!0,value:a(h),onPage:o[3]||(o[3]=s=>a(_)(s)),onSort:o[4]||(o[4]=s=>a($)(s)),sortMode:"multiple",multiSortMeta:a(d).multiSortMeta,totalRecords:a(m),rows:5,rowsPerPageOptions:[5,10,20,50,100],scrollable:!0,first:a(d).first,scrollHeight:"60vh",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"{first} to {last} of total {totalRecords}",loading:a(V),responsiveLayout:"scroll",selectionMode:"single"},{header:v(()=>[i("div",qe,[j.$can("create","MyCase")?(p(),I(L,{key:0,to:{name:"newCase",query:{online:a(c)}}},{default:v(()=>[g(a(T),{class:"mb-2 flex-2",label:"New",icon:"pi pi-plus",severity:"primary"})]),_:1},8,["to"])):S("",!0),i("span",Ee,[Ae,g(a(ve),{modelValue:a(u),"onUpdate:modelValue":o[2]||(o[2]=s=>F(u)?u.value=s:null),placeholder:"Keyword Search",class:"w-full md:w-auto"},null,8,["modelValue"])]),g(a(fe),{ref_key:"columnMenu",ref:x,appendTo:"body",id:"columnPanel",style:{width:"250px"}},{default:v(()=>[(p(!0),w(N,null,E(a(z),s=>(p(),w("div",{key:s.field,class:"field-checkbox"},[g(a(me),{inputId:s.field,name:"column",modelValue:s.selected,binary:!0,onChange:y=>s.selected=!s.selected,disabled:s.frozen},null,8,["inputId","modelValue","onChange","disabled"]),i("label",{for:s.field},C(s.header),9,Te)]))),128))]),_:1},512)])]),empty:v(()=>[A(" No records found. ")]),loading:v(()=>[A(" Loading records data. Please wait. ")]),default:v(()=>[(p(!0),w(N,null,E(a(k),s=>(p(),I(a(ye),{key:s.field,field:s.field,header:s.header,sortable:s.sortable,frozen:!a(D)&&s.frozen,alignFrozen:s.alignFrozen,style:oe(s.style)},{body:v(({data:y})=>[j.$can("create","MyCase")?(p(),I(L,{key:0,class:"text-black-alpha-90",to:a(c)?{name:"editCase",params:{id:y.id}}:{name:"editCaseOffline",params:{id:y.id}}},{default:v(()=>[s.field==="am_number"?(p(),w("div",Ue,C(y.am_number),1)):S("",!0),s.field==="patient_name"?(p(),w("div",Ke,C(a(c)?y.biographic_info&&y.biographic_info.patient_name!==void 0?y.biographic_info.patient_name:"":y.patient_name),1)):S("",!0)]),_:2},1032,["to"])):S("",!0)]),_:2},1032,["field","header","sortable","frozen","alignFrozen","style"]))),128))]),_:1},8,["value","multiSortMeta","totalRecords","first","loading"])])]),g(a(ge),null,{message:v(s=>[i("div",He,[i("i",{class:re([s.message.icon,"mt-2 text-red-500 text-5xl"])},null,2),i("div",Je,C(s.message.message),1)])]),_:1})],64)}}},rt=se(We,[["__scopeId","data-v-1fdf397a"]]);export{rt as default};
